Crystal v3 ã¯ã€Windows ä¸Šã§ãƒ©ãƒ³ã‚µãƒ ã‚¦ã‚§ã‚¢ã®ã‚ˆã†ãªä¸å¯©æŒ™å‹•ã‚’æ¤œçŸ¥ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ãŸã€æ•™è‚²ãƒ»ç ”ç©¶ç”¨é€”å‘ã‘ã®æ¦‚å¿µå®Ÿè¨¼ï¼ˆProof of Conceptï¼‰ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚æœ¬ãƒ„ãƒ¼ãƒ«ã¯é˜²å¾¡æ©Ÿèƒ½ã®ã‚¢ã‚¤ãƒ‡ã‚¢æ¤œè¨¼ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å®Ÿé‹ç”¨ç’°å¢ƒã§ã®åˆ©ç”¨ã‚„å®Œå…¨ãªä¿è­·ã‚’ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

ã€ä¸»ãªæ©Ÿèƒ½ã€‘
ãƒ»ç›£è¦–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆã®æ¤œçŸ¥ï¼ˆwatchdog ä½¿ç”¨ï¼‰
ãƒ»CANARY ãƒ•ã‚¡ã‚¤ãƒ«ã®è‡ªå‹•ç”Ÿæˆã¨ç›£è¦–
ãƒ»é«˜ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼åŒ–ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œçŸ¥
ãƒ»é«˜æ›¸ãè¾¼ã¿ãƒ¬ãƒ¼ãƒˆã‚’ç¤ºã™ãƒ—ãƒ­ã‚»ã‚¹ã®æ¤œå‡ºãŠã‚ˆã³ killï¼ˆè¨­å®šã«ã‚ˆã‚Šå®Ÿè¡Œï¼‰
ãƒ»ä¸å¯©æ‹¡å¼µå­ã®ç”Ÿæˆæ¤œçŸ¥
ãƒ»å¤§é‡ãƒªãƒãƒ¼ãƒ ï¼ˆburst renameï¼‰æŒ™å‹•ã®æ¤œçŸ¥
ãƒ»ãƒ¬ã‚¸ã‚¹ãƒˆãƒª Run ã‚­ãƒ¼ã®ç›£è¦–
ãƒ»ãƒãƒ‹ãƒ¼ãƒãƒ¼ãƒˆï¼ˆç–‘ä¼¼ SMB é¢¨ãƒãƒ¼ãƒˆï¼‰ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¤œçŸ¥
ãƒ»ç–‘ã‚ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’éš”é›¢ãƒ•ã‚©ãƒ«ãƒ€ã¸ã‚³ãƒ”ãƒ¼ï¼ˆactive mode æ™‚ï¼‰
ãƒ»ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆç®¡ç† GUI
ãƒ»ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ­ã‚°ã¨ãƒªã‚¹ã‚¯ã‚¹ã‚³ã‚¢è¡¨ç¤º
ãƒ»ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒç„¡ã„å ´åˆã®è‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨å†èµ·å‹•

ã€å‹•ä½œãƒ¢ãƒ¼ãƒ‰ã€‘
ãƒ»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¢ãƒ¼ãƒ‰ï¼ˆdry_run=Trueï¼‰
ã€€æ¤œçŸ¥ã®ã¿ã§ killãƒ»éš”é›¢ãƒ»é˜²å¾¡ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã›ã‚“ã€‚
ãƒ»ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ï¼ˆdry_run=Falseï¼‰
ã€€ãƒ—ãƒ­ã‚»ã‚¹çµ‚äº†ã€éš”é›¢ã€Firewall ä¸€æ‹¬é®æ–­ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‰ãƒ©ã‚¤ãƒ–åˆ‡æ–­ã€VSS ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãªã©ã‚’å®Ÿéš›ã«è¡Œã„ã¾ã™ã€‚

ã€å¿…è¦ç’°å¢ƒã€‘
ãƒ»Windows 10 / 11ï¼ˆ64bitï¼‰
ãƒ»Python 3.11 ä»¥ä¸Š
ãƒ»ç®¡ç†è€…æ¨©é™ï¼ˆå¿…é ˆï¼‰
ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šï¼ˆåˆå›ã®ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªè‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«å¿…è¦ï¼‰

ã€ä¾å­˜é–¢ä¿‚ã€‘ï¼ˆã‚³ãƒ¼ãƒ‰ã‚ˆã‚ŠæŠ½å‡ºæ¸ˆã¿ï¼‰
ãƒ»watchdog
ãƒ»psutil
ãƒ»pywin32ï¼ˆwin32api ã®ãŸã‚ï¼‰
ã“ã‚Œã‚‰ã¯èµ·å‹•æ™‚ã«è‡ªå‹•ãƒã‚§ãƒƒã‚¯ã•ã‚Œã€ä¸è¶³ã—ã¦ã„ã‚Œã° GUI ã§ç¢ºèªå¾Œ pip ã«ã‚ˆã‚Šè‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã€å†èµ·å‹•ã•ã‚Œã¾ã™ã€‚

ã€ç›£è¦–å¯¾è±¡ã€‘
ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—
ãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
ï¼ˆconfig_v3.json ã«ã¦å¤‰æ›´å¯èƒ½ï¼‰

ã€ãƒˆãƒªã‚¬ãƒ¼æ¡ä»¶ï¼ˆæŠœç²‹ï¼‰ã€‘
ãƒ»CANARY ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§¦ã‚‰ã‚Œã‚‹
ãƒ»é«˜ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒé€£ç¶šã§ç”Ÿæˆãƒ»æ›´æ–°ã•ã‚Œã‚‹
ãƒ»å¤§é‡ã® rename ã‚¤ãƒ™ãƒ³ãƒˆ
ãƒ»ä¸å¯©æ‹¡å¼µå­ï¼ˆ.encrypted / .crypted ãªã©ï¼‰ã®ç”Ÿæˆ
ãƒ»ãƒ¬ã‚¸ã‚¹ãƒˆãƒª Run ã‚­ãƒ¼ãŒå¤‰åŒ–
ãƒ»ãƒãƒ‹ãƒ¼ãƒãƒ¼ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹
ãƒ»ãƒ—ãƒ­ã‚»ã‚¹ã®é«˜é€Ÿæ›¸ãè¾¼ã¿ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ 50MB/s è¶…ï¼‰

ã“ã‚Œã‚‰ã‚’ã‚¹ã‚³ã‚¢åŒ–ã—ã€é–¾å€¤ã«é”ã—ãŸå ´åˆã«é˜²å¾¡ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œï¼ˆã¾ãŸã¯ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã—ã¾ã™ã€‚

ã€æ³¨æ„äº‹é …ã€‘
ãƒ»æœ¬ãƒ„ãƒ¼ãƒ«ã¯ Windows ã®ã‚·ã‚¹ãƒ†ãƒ  APIãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ãƒ»ãƒ—ãƒ­ã‚»ã‚¹æ“ä½œãƒ»ãƒ¬ã‚¸ã‚¹ãƒˆãƒªæ“ä½œã‚’è¡Œã„ã¾ã™ã€‚
ãƒ»èª¤æ¤œçŸ¥ã«ã‚ˆã‚Šæ­£è¦ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒ kill ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
ãƒ»é‡è¦ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã‚‹ç’°å¢ƒã§ã¯çµ¶å¯¾ã«ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚
ãƒ»å¿…ãšä»®æƒ³ç’°å¢ƒãƒ»ãƒ†ã‚¹ãƒˆç”¨ PC ã§ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚
ãƒ»å­¦æ ¡ãƒ»ä¼æ¥­ãƒ»ä»–è€…æ‰€æœ‰ã® PC ã«ç„¡æ–­ã§å°å…¥ã—ãªã„ã§ãã ã•ã„ã€‚
ãƒ»æ”»æ’ƒç›®çš„ã§ã®åˆ©ç”¨ã¯ç¦æ­¢ã—ã¾ã™ï¼ˆæ”»æ’ƒç”¨ã‚³ãƒ¼ãƒ‰ã¯å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ï¼‰ã€‚

ã€å…è²¬äº‹é …ï¼ˆé‡è¦ãƒ»å¼·åŒ–ç‰ˆï¼‰ã€‘
Crystal v3 ã¯ã€Œç¾çŠ¶ã®ã¾ã¾ (AS IS)ã€ã§æä¾›ã•ã‚Œã€ã„ã‹ãªã‚‹ç¨®é¡ã®ä¿è¨¼ã‚‚è¡Œã„ã¾ã›ã‚“ã€‚
é–‹ç™ºè€…ã¯ã€ä»¥ä¸‹ã‚’å«ã‚€ã‚ã‚‰ã‚†ã‚‹æå®³ãƒ»ä¸å…·åˆã«ã¤ã„ã¦ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚
ãƒ»ãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±ã€ç ´æ
ãƒ»ã‚·ã‚¹ãƒ†ãƒ éšœå®³ã€OS å‹•ä½œä¸å…¨
ãƒ»ãƒ—ãƒ­ã‚»ã‚¹ kill ã«ã‚ˆã‚‹æ¥­å‹™åœæ­¢
ãƒ»ä¸æ­£æ¤œçŸ¥ãƒ»èª¤æ¤œçŸ¥
ãƒ»èª¤è¨­å®šã‚„åˆ©ç”¨è€…ã®æ“ä½œã«ã‚ˆã‚‹å½±éŸ¿
ãƒ»æœ¬ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ãŸçµæœç”Ÿã˜ãŸç›´æ¥çš„ãƒ»é–“æ¥çš„ãªæå®³
æœ¬ãƒ„ãƒ¼ãƒ«ã®ä½¿ç”¨ã«ã‚ˆã‚Šç”Ÿã˜ãŸçµæœã¯ã™ã¹ã¦åˆ©ç”¨è€…è‡ªèº«ã®è²¬ä»»ã¨ãªã‚Šã¾ã™ã€‚
æœ¬ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ãŸæ™‚ç‚¹ã§ã€åˆ©ç”¨è€…ã¯ã“ã‚Œã‚‰ã®å…è²¬ã«åŒæ„ã—ãŸã‚‚ã®ã¨ã—ã¾ã™ã€‚

ã€ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã€‘
MIT Licenseï¼ˆã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®åˆ©ç”¨è²¬ä»»ã¯å…¨ã¦åˆ©ç”¨è€…ã«ã‚ã‚Šã¾ã™ï¼‰

ğŸ‡ºğŸ‡¸ Crystal v3 â€” README (Text Only / Strong Disclaimer)

Crystal v3 is a Proof-of-Concept (PoC) tool designed for educational and research purposes to illustrate defensive techniques against ransomware-like behavior on Windows systems. It is not intended for production use, and it does not guarantee any form of full protection.

[Key Features]

File system monitoring using watchdog

Automatic creation and monitoring of CANARY files

High-entropy file detection

Process write-rate monitoring with optional automatic termination

Detection of suspicious extensions

Burst rename detection

Registry monitoring for Run keys

Honeypot TCP ports

Automatic isolation copy for suspicious files (active mode only)

GUI with whitelist management

Real-time log and scoring system

Automatic dependency installation with restart

[Modes]
Simulation mode (dry_run=True): detection only.
Active mode (dry_run=False): process termination, isolation, firewall blocking, disconnecting network drives, and VSS snapshot creation.

[Requirements]

Windows 10 / 11 (64-bit)

Python 3.11+

Administrator privileges (mandatory)

Internet access for first-time dependency installation

[Monitored Targets]

Desktop

Documents
(these can be changed in config_v3.json)

[Trigger Examples]

CANARY file modification

Multiple high-entropy file writes

Burst rename events

Creation of suspicious file extensions

Registry Run key changes

Honeypot port connections

High write-rate processes (default 50MB/s)

Once the internal score exceeds the configured threshold, defensive actions are triggered (or simulated).

[Important Notes]

This tool interacts with low-level Windows APIs, processes, registry keys, and filesystem events.

False positives may kill legitimate processes.

Do NOT use this on machines containing important data.

Only use inside virtual machines or testing PCs.

Do NOT install on computers you do not own.

Offensive or malicious use is prohibited (no attack code is included).

[Disclaimer (Strong)]
Crystal v3 is provided strictly â€œAS IS,â€ without any warranties, express or implied.
The developer assumes absolutely no responsibility for any kind of damage or loss, including but not limited to:

data loss or corruption

system instability or failure

termination of legitimate processes

false positives or misdetections

improper configuration or misuse

any direct, indirect, incidental, or consequential damages
All risks and responsibilities related to the use of this tool rest entirely with the user.
By using this software, the user agrees to all responsibility and fully accepts the disclaimer.

[License]
MIT License (All responsibility of use lies solely with the user)
